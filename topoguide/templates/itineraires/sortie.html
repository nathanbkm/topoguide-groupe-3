
{% extends 'base.html' %}
<!--Title of the page-->
{% block title %}
Sortie de {{ trip.user.username }}
{% endblock %}

{% load static %}

{% block body %}

<h1>
    <a href="{% url 'itin:detail_route' trip.route.id%}">
        {{ route.title }} 
    </a> - Sortie de {{ trip.user.username }}
</h1>
<table>
    <tr>
        <th>Date de la sortie</th>
        <td>{{ trip.date }}</td>
    </tr>
    <tr>
        <th>Durée réelle</th>
        <td>{{ trip.time_display }}</td>
    </tr>
    <tr>
        <th>Nombre de participants</th>
        <td>{{ trip.number_people }}</td>
    </tr>
    <tr>
        <th>Expérience du groupe</th>
        <td>{{ trip.get_group_xp_display}}</td>
    </tr>
    <tr>
        <th>Conditions météo</th>
        <td>{{ trip.get_weather_display}}</td>
    </tr>
    <tr>
        <th>Difficulté ressentie</th>
        <td>{{ trip.difficulty_felt }}/5</td>
    </tr>
</table>
<a href="{% url 'itin:detail_route' route.id%}">
    <button class="button-31">Retour aux sorties de {{ trip.route }}</button>
</a>

<h2>Images</h2>

{% if photos %}
    {% for photo in photos%}
        <img src= "{{ photo.image.url }}">
    {% endfor %}
{% else %}
    <p> Pas encore de photos pour cette sortie.</p>
{% endif %}


{% if user == trip.user%}
    <a href="{% url 'itin:new_image' trip.id%}">
        <button class="button-31">Ajouter des images</button>
    </a>
{% endif %}

<h2>Commentaires</h2>

<!--Form-->
<form method="post" >
    {% csrf_token %}
    {{form}}
    <input class="normal" type="submit" value="Partager">
</form>

{% if comments %}
    <table>
        <tr>
            <th>Par</th>
            <th>Le</th>
            <th>Description</th>
        </tr>
        {% for comment in comments %}
            {% if comment.mod_status == 'PU' %}
                <tr>
                    <td>{{ comment.author }}</td>
                    <td>{{ comment.pub_date }}</td>
                    <td>{{ comment.description }}</td>
                </tr>
            {% elif comment.mod_status == 'PR' and comment.author == request.user %}
                <tr>
                    <td>{{ comment.author }}</td>
                    <td>{{ comment.pub_date }}</td>
                    <td>{{ comment.description }}</td>
                </tr> 
            {% elif comment.mod_status == 'HI' %}
                {% if comment.author == request.user or trip.user == request.user %}
                <tr>
                    <td>{{ comment.author }}</td>
                    <td>{{ comment.pub_date }}</td>
                    <td>{{ comment.description }}</td>
                </tr>
                {% endif %}
            {% endif %}
        {% endfor %}
    </table>
{% else %}
    <p class="rawtext">Pas encore de commentaires. <br> Soyez le premier à ajouter
    un commentaire pour cette sortie. </p>
{% endif %}

{% endblock %}